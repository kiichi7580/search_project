{% extends 'base.html' %}

{% block content %}
  <div class="container mt-5">
    {% include 'search_area.html' %}

    <ul class="list-group mt-4">
      {% for book in page_obj %}
        <li class="list-group-item">
          <div>
            <h5>{{ book.title }}</h5>
            <p>著者: {{ book.author }}</p>
            <p>{{ book.isbn }}</p>
          </div>
          {% if book.cover_url %}
            <div>
              <img src="{{ book.cover_url }}" alt="{{ book.title }}" height="150">
            </div>
          {% else %}
              <p>カバー画像はありません。</p>
          {% endif %}
          <div class="d-flex justify-content-center align-items-center mt-4 gap-2">
            <a href="{% url 'book_detail' book.id %}" class="btn btn-outline-primary me-2">詳細</a>
            <a href="{% url 'book_update' book.id %}" class="btn btn-outline-success me-2">編集</a>
            <form id="deleteForm" action="{% url 'book_delete' book.id %}" method="POST" onsubmit="return confirm('本当に削除しますか？');">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-danger me-2">削除</button>
            </form>
          </div>
        </li>
      {% empty %}
        <li class="list-group-item">書籍がありません。</li>
      {% endfor %}
    </ul>
  </div>

  <div class="pagination d-flex justify-content-center">
    <span class="step_links">
      {% if page_obj.has_previous %}
        <a href="?page=1">最初</a>
        <a href="?page={{ page_obj.previous_page_number }}">前へ</a>
      {% endif %}
      <span class="current">
        ページ {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
      </span>
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">次へ</a>
        <a href="?page={{ page_obj.paginator.num_pages }}">最後</a>
      {% endif %}
    </span>
  </div>
{% endblock %}